Coloring algorithm is wrong. Everything gets colored to rsi. Definitely some weird memory management I'm doing. Gotta go through it line by line. 